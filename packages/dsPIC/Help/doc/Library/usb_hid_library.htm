
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>

<title>USB HID Library</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Copyright" content="mikroElektronika 2005.">
<meta name="Author" content="Nikola Topalovic. mailto:office@mikroelektronika.co.yu">

<link rel="stylesheet" type="text/css" href="css/help_c_dspic.css">
<script defer type="text/javascript" src="css/pngfix.js"></script>


	






<style type="text/css">
#top {
  background:transparent url(template/background_C_dsPIC.png); 
}

.title{
	PADDING-RIGHT: 2px; 
	PADDING-LEFT: 70px; 
	FONT-WEIGHT: bold; 
	FONT-SIZE: 14px; 
	PADDING-BOTTOM: 3px; 
	PADDING-TOP: 0px; 
	FONT-FAMILY: Verdana;
  color:white;
}

.navigation{
                     PADDING-TOP: -5px;
	PADDING-RIGHT: 2px; 
	PADDING-LEFT: 63px; 
	FONT-SIZE: 11px; 
	FONT-FAMILY: Verdana;
                     color:white;
}

.navigation a:link {text-decoration: none; color: white;}
.navigation a:visited {text-decoration: none; color: white;}
.navigation a:active {text-decoration: none; color: white;}
.navigation a:hover {text-decoration: none; color: white; background:black;}

.nav_bar {
}

#top td p,td pre {
	margin:0 0 0 0;
}
</style>

<style type="text/css" media="screen">
#main{
	border-top: 1px solid #000000;
  padding-left: 15px;
  padding-right: 15px;
	position: absolute;
	top: 59px;
	right: 0px;
	bottom: 0px;
	left: 0px;

	width: expression(document.body.offsetWidth - 3);
	height: expression(document.body.offsetHeight -  65);
	overflow: auto;
}
</style>

</head>


<body>

<div id="top">
<table height="60" width="100%">
  <tbody>
	  <tr>
		  <td>
			  <pre class="nav_bar"><div class="title">USB HID Library</div><div class="navigation">&nbsp;&nbsp;<A href="mikroc_libraries.htm">mikroC PRO for dsPIC30/33 and PIC24 Libraries</A> &gt; <A href="mikroC_hardware_libraries.htm">Hardware Libraries</A> &gt; </div></pre>
			</td>
		  <td style="WIDTH: 120px" align="right">
			  <pre class="nav_bar"><A href="uart_library.htm" title="Previous"><img src="template\btn_prev_n.png" border="0"></a>&nbsp;<A title="Top of the Page" href="#top_of_page" alt="Top of the Page"><IMG src="template/btn_up_n.png" border=0 ></a>&nbsp;<A href="dsp_library.htm" title="Next"><img src="template\btn_next_n.png" border="0"></a></pre>
			</td>
		</tr>
	</tbody>
</table>
</div>

	


  <div id="main">

    <a name="top_of_page"><h2>USB HID Library</h2></a>

    <p>Universal Serial Bus (USB) provides a serial bus standard for connecting a wide variety of devices, including computers, cell phones, game consoles, <acronym title="Personal Digital Assistant">PDA</acronym>&#8217;s, etc.</p>
    <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> Library contains <acronym title="Human Interface Device">HID</acronym> routines that support HID class devices, and also the generic routines that can be used with vendor specified drivers.</p>

    <h3><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> Class</h3>

    <p>The <acronym title="Human Interface Device">HID</acronym> class consists primarily of devices that are used by humans to control the operation of computer systems. Typical examples of <acronym title="Human Interface Device">HID</acronym> class devices include :</p>
    <ul>
	    <li>Keyboards and pointing devices, for example: standard mouse devices, trackballs, and joysticks.</li>
	    <li>Front-panel controls, for example: knobs, switches, buttons, and sliders.</li>
	    <li>Controls that might be found on devices such as telephones, VCR remote controls, games or simulation devices, for example: data gloves, throttles, steering wheels, and rudder pedals.</li>
	    <li>Devices that may not require human interaction but provide data in a similar format to <acronym title="Human Interface Device">HID</acronym> class devices, for example, bar-code readers, thermometers, or voltmeters.</li>
    </ul>

    <p>Many typical <acronym title="Human Interface Device">HID</acronym> class devices include indicators, specialized displays, audio feedback, and force or tactile feedback. Therefore, the <acronym title="Human Interface Device">HID</acronym> class definition includes support for various types of output directed to the end user.</p>

    <!-- -->


    <h4>Descriptor File</h4>
    <p>Each project based on the <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> library should include a descriptor source file which contains vendor id and name, product id and name, report length, and other relevant information. To create a descriptor file, use the integrated <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> terminal of mikroC PRO for dsPIC30/33 and PIC24(<b>Tools&#160;&#8250;&#160;USB&#160;HID&#160;Terminal</b>). The default name for descriptor file is <code>USBdsc.c</code>, but you may rename it.</p>
    <p>Due to the specific nature of <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> module, bear in mind that when defining endpoint descriptors, don't define two descriptors with the same number (numerical representation) of endpoints and different directions.
    <br>This means that <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> library example has endpoints defined as 1(IN) and 2(OUT), which shouldn't be defined as 1(IN) i 1(OUT).</p>



    <!-- -->


    <h3>Library Routines</h3>

    <ul>
      <li><a href="#hid_enable">HID_Enable</a></li>
      <li><a href="#hid_read">HID_Read</a></li>
      <li><a href="#hid_write">HID_Write</a></li>
      <li><a href="#hid_disable">HID_Disable</a></li>
      <li><a href="#usb_interrupt_proc">USB_Interrupt_Proc</a></li>
      <li><a href="#usb_polling_proc">USB_Polling_Proc</a></li>
      <li><a href="#gen_enable">Gen_Enable</a></li>
      <li><a href="#gen_read">Gen_Read</a></li>
      <li><a href="#gen_write">Gen_Write</a></li>
      <li><a href="#usb_break">USB_Break</a></li>
    </ul>


    <!-- -->


    <h3 id="hid_enable">HID_Enable</h3>


    <!-- tabela: HID_Enable-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> HID_Enable(<b>char</b> *readbuff, <b>char</b> *writebuff);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Enables <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> communication.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <ul>
	            <li><code>readbuff:</code> Read Buffer.</li>
	            <li><code>writebuff:</code> Write Buffer.</li>
            </ul>
            <p>These parameters are used for <acronym title="Human Interface Device">HID</acronym> communication.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
HID_Enable(&readbuff,&writebuff);</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>This function needs to be called before using other routines of <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> Library.</p>
          </td>
        </tr>

      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="hid_read">HID_Read</h3>


    <!-- tabela: HID_Read-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>char</b> HID_Read(<b>void</b>);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Receives message from host and stores it in the Read Buffer.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>If the data reading has failed, the function returns 0. Otherwise, it returns number of characters received from the host.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<i>// retry until success</i>
<b>while</b>(!HID_Read())
  ;</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>
        
      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="hid_write">HID_Write</h3>


    <!-- tabela: HID_Write-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>char</b> HID_Write(<b>char</b> *writebuff, <b>char</b> len);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Function sends data from Write Buffer <code>writebuff</code> to host.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <ul>
	            <li><code>writebuff:</code> Write Buffer, same parameter as used in initialization; see <a href="#hid_enable">HID_Enable</a>.</li>
	            <li><code>len:</code> specifies a length of the data to be transmitted.</li>
            </ul>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
       		  <p>If the data transmitting has failed, the function returns 0. Otherwise, it returns number of transmitted bytes.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<i>// retry until success</i>
<b>while</b>(!HID_Write(&writebuff,64))
  ;</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>Function call needs to be repeated as long as data is not successfuly sent.</p>
            <p>This is a blocking routine which can block the program flow. Calling <a href="#usb_break">USB_Break</a> routine from the interrupt will unblock the program execution.</p>
          </td>
        </tr>
        
      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="hid_disable">HID_Disable</h3>


    <!-- tabela: HID_Disable-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> HID_Disable(<b>void</b>);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Disables <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> communication.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
HID_Disable();</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>
        
      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="usb_interrupt_proc">USB_Interrupt_Proc</h3>


    <!-- tabela: USB_Interrupt_Proc-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> USB_Interrupt_Proc(<b>void</b>);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>This routine is used for servicing various <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> bus events. Should be called inside <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> interrupt routine.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<b>void</b> USB1Interrupt() <b>iv</b> IVT_ADDR_USB1INTERRUPT {
  USB_Interrupt_Proc();
}</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>Do not use this function with <a href="#usb_polling_proc">USB_Polling_Proc</a>, only one should be used. To enable servicing through interrupt, <code>USB_INTERRUPT</code> constant should be set (it is set by default in descriptor file).</p>
          </td>
        </tr>

      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="usb_polling_proc">USB_Polling_Proc</h3>


    <!-- tabela: USB_Polling_Proc-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> USB_Polling_Proc(<b>void</b>);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>This routine is used for servicing various <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> bus events. It should be periodically, preferably every 100 microseconds.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<b>while</b>(1) {
  USB_Polling_Proc();
  kk = HID_Read();
  <b>if</b> (kk != 0) {
    <b>for</b>(cnt=0; cnt < 64; cnt++)
      writebuff[cnt]=readbuff[cnt];
  HID_Write(&writebuff,64);
  }
}</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>Do not use this functions with <a href="#usb_interrupt_proc">USB_Interrupt_Proc</a>. To enable servicing by polling, <code>USB_INTERRUPT</code> constant should be set to 0 (it is located in descriptor file).</p>
          </td>
        </tr>
        
      </tbody>

    </table>
    
    <!-- kraj tabele -->


    <!-- -->


    <h3 id="gen_enable">Gen_Enable</h3>


    <!-- tabela: Gen_Enable-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> Gen_Enable(<b>char</b>* readbuff, <b>char</b>* writebuff);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Initializes the <acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> module.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <ul>
	            <li><code>readbuff:</code> Read Buffer.</li>
	            <li><code>writebuff:</code> Write Buffer.</li>
            </ul>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> communication needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
Gen_Enable(&readbuff,&writebuff);</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>
        
      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="gen_read">Gen_Read</h3>


    <!-- tabela: Gen_Read-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>char</b> Gen_Read(<b>char</b> *readbuff, <b>char</b> length, <b>char</b> ep);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Generic routine that receives the specified data from the specified endpoint.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <ul>
	            <li><code>readbuff:</code> Received data.</li>
	            <li><code>length:</code> The length of the data that you wish to receive.</li>
	            <li><code>ep:</code> Endpoint number you want to receive the data into.</li>
            </ul>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Returns the number of received bytes, otherwise 0.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym> needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<b>while</b>(Gen_Read(readbuff,64,1)==0)
  ;</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>
        
      </tbody>

    </table>

    <!-- kraj tabele -->


    <!-- -->


    <h3 id="gen_write">Gen_Write</h3>


    <!-- tabela: Gen_Write-->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>char</b> Gen_Write(<b>char</b>* writebuff, <b>char</b> length, <b>char</b> ep);</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p>Sends the specified data to the specified endpoint.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <ul>
	            <li><code>writebuff:</code> The data that you want to send.</li>
	            <li><code>length:</code> the length of the data that you wish to send.</li>
	            <li><code>ep:</code> Endpoint number you want to send the data into.</li>
            </ul>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Returns the number of transmitted bytes, otherwise 0.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            <p><acronym title="Universal Serial Bus">USB</acronym> <acronym title="Human Interface Device">HID</acronym>needs to be enabled before using this function. See <a href="#hid_enable">HID_Enable</a>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">

<pre>
<b>while</b>(Gen_Write(writebuff,64,1)==0)
  ;</pre>

          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>This is a blocking routine which can block the program flow. Calling <a href="#usb_break">USB_Break</a> routine from the interrupt will unblock the program execution.</p>
          </td>
        </tr>
        
      </tbody>

    </table>


    <h3 id="usb_break">USB_Break</h3>


    <!-- tabela: USB_Break -->

    <table class="routine" width="100%">

      <!--
      <caption></caption>

      <thead></thead>
      -->

      <tbody>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th width="0" valign="top">Prototype</th>
          <td class="code" width="100%" valign="top">
            <p><b>void</b> USB_Break();</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Description</th>
          <td valign="top">
            <p><a href="#hid_write">HID_Write</a> and <a href="#gen_write">Gen_Write</a> are blocking routines and they can block the program flow. Calling <code>USB_Break()</code> routine from the interrupt will unblock the program execution. Calling this routine from interrupt will unblock the program execution. This mechanism is similar to <acronym title="Watch Dog Timer">WDT</acronym>.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Parameters</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Returns</th>
          <td valign="top">
            <p>Nothing.</p>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Requires</th>
          <td valign="top">
            Nothing.
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Example</th>
          <td valign="top">
<pre>
</pre>
          </td>
        </tr>

        <tr style="background:'white'" onmouseover="this.style.background='#f8f8f8';" onmouseout="this.style.background='white';">
          <th valign="top">Notes</th>
          <td valign="top">
            <p>None.</p>
          </td>
        </tr>
        
      </tbody>

    </table>


    <h3>Library Example</h3>

    <p>This example establishes connection with the HID terminal that is active on the PC. Upon connection establishment, the HID Device Name will appear in the respective window. After that software will wait for data and
     it will return received data back. Examples uses <code>USBdsc.c</code> descriptor file, which is in the same folder, and can be created by the HID Terminal.</p>

<div class="example">
  <textarea style="display:none;"></textarea> 
  <span class="copytoclipboard"><a onclick="copyToClipboard(this); return false;" href="#"><img align="absmiddle" alt="Copy Code To Clipboard" src="img/copy_to_clipboard.png" border="0" /><span class="clipboard_text">Copy Code To Clipboard</span></a></span>
</div>

<pre class="program">
<b>char</b> cnt;
<b>char</b> readbuff[64];
<b>char</b> writebuff[64];

<b>void</b> USB1Interrupt() <b>iv</b> IVT_ADDR_USB1INTERRUPT {
   USB_Interrupt_Proc();
}

<b>void</b> main(<b>void</b>){
  AD1PCFGL = 0xFFFF;

  HID_Enable(&#38;readbuff,&#38;writebuff);

  <b>while</b>(1){
    <b>while</b>(!HID_Read())
      ;

    <b>for</b>(cnt=0;cnt&#60;64;cnt++)
      writebuff[cnt]=readbuff[cnt];

    <b>while</b>(!HID_Write(&#38;writebuff,64))
      ;
  }
}
</pre>

    <!-- -->


    <h3>HW Connection</h3>

    <p class="center"><img alt="USB connection scheme" src="img/schemes/scheme_usb.gif"></p>
    <p class="center small">USB connection scheme</p>

    <div class="feedback">
            Copyright (c) 2002-2018 mikroElektronika. All rights reserved.
      <br>What do you think about this topic ?  <a href="https://helpdesk.mikroe.com/conversation/new/3">Send us feedback!</a>
    </div>

      <div class="libstock">Want more examples and libraries?&nbsp;
     <br>Find them on
     <a href="http://www.libstock.com/" target="_blank"><img alt="LibStock - A place for the code" src="img/libstock.gif" border="0" align="absmiddle"></a>
    </div>

  </div><!--/main-->




</body>

</html>
